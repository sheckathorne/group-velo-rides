{% load embedded_map_from integer_to_hour_text from group_velo_events_tags %}

<div class="mt-4 p-4 bg-gray-100 dark:bg-gray-800/50 rounded-lg">
  <!-- Hourly forecast -->
  <div class="mt-2 w-full">
    <h5 class="text-sm font-medium mb-2">Hourly Forecast</h5>
    <div class="overflow-x-auto pb-2">
      <div class="flex gap-5 min-w-max">
        {% for forecast in event_occurence.weather.hours %}
          <div class="flex flex-col items-center bg-background/50 dark:bg-background/20 rounded-md p-2 min-w-[80px]">
            <span class="text-xs font-medium">{{ forecast.hour|integer_to_hour_text }}</span>
            <span class="weather-icon my-1"
                  x-tooltip.raw="{{ forecast.condition_text }}">
              <img src="http:{{ forecast.condition_icon_url }}"
                   width="36"
                   height="36"
                   alt="Hourly Weather Icon - {{ forecast.condition_text }}" />
            </span>
            <span class="text-sm font-medium">{{ forecast.temperature_f|floatformat:0 }}°F</span>
            <span class="text-xs text-muted-foreground">Feels {{ forecast.feelslike_f|floatformat:0 }}°F</span>
            <div class="flex items-center gap-1 mt-1">
              <svg xmlns="http://www.w3.org/2000/svg"
                   width="24"
                   height="24"
                   viewBox="0 0 24 24"
                   fill="none"
                   stroke="currentColor"
                   stroke-width="2"
                   stroke-linecap="round"
                   stroke-linejoin="round"
                   class="lucide lucide-droplets h-3 w-3 text-blue-400">
                <path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z" />
                <path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97" />
              </svg>
              <span class="text-xs">{{ forecast.chance_of_precip }}%</span>
            </div>
            <div class="flex items-center gap-1 mt-1">
              <svg xmlns="http://www.w3.org/2000/svg"
                   width="12"
                   height="12"
                   viewBox="0 0 24 24"
                   fill="none"
                   stroke="currentColor"
                   stroke-width="2"
                   stroke-linecap="round"
                   stroke-linejoin="round"
                   class="text-muted-foreground">
                <path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2" />
                <path d="M9.6 4.6A2 2 0 1 1 11 8H2" />
                <path d="M12.6 19.4A2 2 0 1 0 14 16H2" />
              </svg>
              <span class="text-xs">{{ forecast.wind_mph }} mph</span>
            </div>
            <span class="text-xs text-muted-foreground">{{ forecast.wind_direction }}</span>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
  <div class="mt-3 text-xs text-gray-500 dark:text-gray-400">
    Weather forecast for {{ event_occurence.start_time|date:"F j" }} at {{ event_occurence.route.start_location_name }}
  </div>
</div>
